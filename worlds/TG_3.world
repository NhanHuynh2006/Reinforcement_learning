<?xml version="1.0" ?>
<sdf version="1.6">
  <world name="lane_circle_world">

    <!-- ROS plugins -->
    <plugin name="gazebo_ros" filename="libgazebo_ros_init.so">
      <ros>
        <namespace>/</namespace>
        <argument>--ros-args</argument>
      </ros>
    </plugin>
    <plugin name="gazebo_ros_factory" filename="libgazebo_ros_factory.so"/>
    <plugin name="gazebo_ros_state" filename="libgazebo_ros_state.so"/>

    <!-- Scene setup -->
    <scene>
      <ambient>0.6 0.6 0.6 1</ambient>
      <background>0.8 0.8 0.8 1</background>
    </scene>

    <include><uri>model://sun</uri></include>
    <include><uri>model://ground_plane</uri></include>

    <!-- ================== CIRCULAR LANES (ARC) ================== -->
    <!-- Tâm (XC,YC) = (15,0). R_center=8 m, offset mép ±1.45m. Z=0.015 nổi trên nền -->

    <!-- Vạch giữa (vàng) -->
<road name="arc_center">
  <width>0.08</width>
  <material>
    <script>
      <uri>file://media/materials/scripts/gazebo.material</uri>
      <name>Gazebo/Yellow</name>
    </script>
  </material>
<point>0.000  0.000  0.015</point>  <!-- θ=-90° -->
<point>1.389  0.122  0.015</point>  <!-- θ=-80° -->
<point>2.736  0.482  0.015</point>  <!-- θ=-70° -->
<point>4.000  1.072  0.015</point>  <!-- θ=-60° -->
<point>5.142  1.872  0.015</point>  <!-- θ=-50° -->
<point>6.128  2.858  0.015</point>  <!-- θ=-40° -->
<point>6.928  4.000  0.015</point>  <!-- θ=-30° -->
<point>7.518  5.264  0.015</point>  <!-- θ=-20° -->
<point>7.878  6.611  0.015</point>  <!-- θ=-10° -->
<point>8.000  8.000  0.015</point>  <!-- θ=0° -->
<point>7.878  9.389  0.015</point>  <!-- θ=10° -->
<point>7.518  10.736  0.015</point>  <!-- θ=20° -->
<point>6.928  12.000  0.015</point>  <!-- θ=30° -->
<point>6.128  13.142  0.015</point>  <!-- θ=40° -->
<point>5.142  14.128  0.015</point>  <!-- θ=50° -->
<point>4.000  14.928  0.015</point>  <!-- θ=60° -->
<point>2.736  15.518  0.015</point>  <!-- θ=70° -->
<point>1.389  15.878  0.015</point>  <!-- θ=80° -->
<point>0.000  16.000  0.015</point>  <!-- θ=90° -->
<point>-1.389  15.878  0.015</point> <!-- θ=100° -->
<point>-2.736  15.518  0.015</point> <!-- θ=110° -->
<point>-4.000  14.928  0.015</point> <!-- θ=120° -->
<point>-5.142  14.128  0.015</point> <!-- θ=130° -->
<point>-6.128  13.142  0.015</point> <!-- θ=140° -->
<point>-6.928  12.000  0.015</point> <!-- θ=150° -->
<point>-7.518  10.736  0.015</point> <!-- θ=160° -->
<point>-7.878  9.389  0.015</point>  <!-- θ=170° -->
<point>-8.000  8.000  0.015</point>  <!-- θ=180° -->
<point>-7.878  6.611  0.015</point>  <!-- θ=190° -->
<point>-7.518  5.264  0.015</point>  <!-- θ=200° -->
<point>-6.928  4.000  0.015</point>  <!-- θ=210° -->
<point>-6.128  2.858  0.015</point>  <!-- θ=220° -->
<point>-5.142  1.872  0.015</point>  <!-- θ=230° -->
<point>-4.000  1.072  0.015</point>  <!-- θ=240° -->
<point>-2.736  0.482  0.015</point>  <!-- θ=250° -->
<point>-1.389  0.122  0.015</point>  <!-- θ=260° -->
<point>-0.000  0.000  0.015</point>  <!-- θ=270° -->
</road>

<!-- Left white edge (inner radius = 6.55 m) -->
    <road name="arc_left">
      <width>0.10</width>
      <material>
        <script>
          <uri>file://media/materials/scripts/gazebo.material</uri>
          <name>Gazebo/White</name>
        </script>
      </material>
    <point>0.000  1.450  0.015</point>  <!-- θ=-90° -->
    <point>1.137  1.550  0.015</point>  <!-- θ=-80° -->
    <point>2.240  1.845  0.015</point>  <!-- θ=-70° -->
    <point>3.275  2.328  0.015</point>  <!-- θ=-60° -->
    <point>4.210  2.982  0.015</point>  <!-- θ=-50° -->
    <point>5.018  3.790  0.015</point>  <!-- θ=-40° -->
    <point>5.672  4.725  0.015</point>  <!-- θ=-30° -->
    <point>6.155  5.760  0.015</point>  <!-- θ=-20° -->
    <point>6.450  6.863  0.015</point>  <!-- θ=-10° -->
    <point>6.550  8.000  0.015</point>  <!-- θ=0° -->
    <point>6.450  9.137  0.015</point>  <!-- θ=10° -->
    <point>6.155  10.240  0.015</point>  <!-- θ=20° -->
    <point>5.672  11.275  0.015</point>  <!-- θ=30° -->
    <point>5.018  12.210  0.015</point>  <!-- θ=40° -->
    <point>4.210  13.018  0.015</point>  <!-- θ=50° -->
    <point>3.275  13.672  0.015</point>  <!-- θ=60° -->
    <point>2.240  14.155  0.015</point>  <!-- θ=70° -->
    <point>1.137  14.450  0.015</point>  <!-- θ=80° -->
    <point>0.000  14.550  0.015</point>  <!-- θ=90° -->
    <point>-1.137  14.450  0.015</point> <!-- θ=100° -->
    <point>-2.240  14.155  0.015</point> <!-- θ=110° -->
    <point>-3.275  13.672  0.015</point> <!-- θ=120° -->
    <point>-4.210  13.018  0.015</point> <!-- θ=130° -->
    <point>-5.018  12.210  0.015</point> <!-- θ=140° -->
    <point>-5.672  11.275  0.015</point> <!-- θ=150° -->
    <point>-6.155  10.240  0.015</point> <!-- θ=160° -->
    <point>-6.450   9.137  0.015</point> <!-- θ=170° -->
    <point>-6.550   8.000  0.015</point> <!-- θ=180° -->
    <point>-6.450   6.863  0.015</point> <!-- θ=190° -->
    <point>-6.155   5.760  0.015</point> <!-- θ=200° -->
    <point>-5.672   4.725  0.015</point> <!-- θ=210° -->
    <point>-5.018   3.790  0.015</point> <!-- θ=220° -->
    <point>-4.210   2.982  0.015</point> <!-- θ=230° -->
    <point>-3.275   2.328  0.015</point> <!-- θ=240° -->
    <point>-2.240   1.845  0.015</point> <!-- θ=250° -->
    <point>-1.137   1.550  0.015</point> <!-- θ=260° -->
    <point>-0.000   1.450  0.015</point> <!-- θ=270° -->
    </road>

    <!-- Right white edge (outer radius = 9.45 m) -->
    <road name="arc_right">
      <width>0.10</width>
      <material>
        <script>
          <uri>file://media/materials/scripts/gazebo.material</uri>
          <name>Gazebo/White</name>
        </script>
      </material>
    <point>0.000  -1.450  0.015</point>  <!-- θ=-90° -->
    <point>1.641  -1.306  0.015</point>  <!-- θ=-80° -->
    <point>3.232  -0.880  0.015</point>  <!-- θ=-70° -->
    <point>4.725  -0.190  0.015</point>  <!-- θ=-60° -->
    <point>6.075   0.734  0.015</point>  <!-- θ=-50° -->
    <point>7.239   1.926  0.015</point>  <!-- θ=-40° -->
    <point>8.184   3.275  0.015</point>  <!-- θ=-30° -->
    <point>8.880   4.768  0.015</point>  <!-- θ=-20° -->
    <point>9.306   6.359  0.015</point>  <!-- θ=-10° -->
    <point>9.450   8.000  0.015</point>  <!-- θ=0° -->
    <point>9.306   9.641  0.015</point>  <!-- θ=10° -->
    <point>8.880  11.232  0.015</point>  <!-- θ=20° -->
    <point>8.184  12.725  0.015</point>  <!-- θ=30° -->
    <point>7.239  14.074  0.015</point>  <!-- θ=40° -->
    <point>6.074  15.239  0.015</point>  <!-- θ=50° -->
    <point>4.725  16.184  0.015</point>  <!-- θ=60° -->
    <point>3.232  16.880  0.015</point>  <!-- θ=70° -->
    <point>1.641  17.306  0.015</point>  <!-- θ=80° -->
    <point>0.000  17.450  0.015</point>  <!-- θ=90° -->
    <point>-1.641  17.306  0.015</point> <!-- θ=100° -->
    <point>-3.232  16.880  0.015</point> <!-- θ=110° -->
    <point>-4.725  16.184  0.015</point> <!-- θ=120° -->
    <point>-6.074  15.239  0.015</point> <!-- θ=130° -->
    <point>-7.239  14.074  0.015</point> <!-- θ=140° -->
    <point>-8.184  12.725  0.015</point> <!-- θ=150° -->
    <point>-8.880  11.232  0.015</point> <!-- θ=160° -->
    <point>-9.306   9.641  0.015</point> <!-- θ=170° -->
    <point>-9.450   8.000  0.015</point> <!-- θ=180° -->
    <point>-9.306   6.359  0.015</point> <!-- θ=190° -->
    <point>-8.880   4.768  0.015</point> <!-- θ=200° -->
    <point>-8.184   3.275  0.015</point> <!-- θ=210° -->
    <point>-7.239   1.926  0.015</point> <!-- θ=220° -->
    <point>-6.075   0.734  0.015</point> <!-- θ=230° -->
    <point>-4.725  -0.190  0.015</point> <!-- θ=240° -->
    <point>-3.232  -0.880  0.015</point> <!-- θ=250° -->
    <point>-1.641  -1.306  0.015</point> <!-- θ=260° -->
    <point>-0.000  -1.450  0.015</point> <!-- θ=270° -->
    </road>
        <!-- ================== OBSTACLES ================== -->
   <gui>
      <camera name="user_camera">
        <pose>0 12 8  -0.8 0 3.14</pose>  <!-- x y z R P Y -->
        <track_visual>false</track_visual>
      </camera>
    </gui>

    <!-- ================== OBSTACLES (each obstacle = its own model) ================== -->

    <!-- Cone #1 -->
    <model name="cone_1">
      <static>true</static>
      <pose>7.30 8.60 0.15 0 0 0</pose>  <!-- z = height/2 -->
      <link name="body">
        <visual name="v">
          <geometry><cylinder><radius>0.12</radius><length>0.30</length></cylinder></geometry>
          <material><ambient>1.0 0.4 0.0 1</ambient><diffuse>1.0 0.4 0.0 1</diffuse></material>
        </visual>
        <collision name="c">
          <geometry><cylinder><radius>0.12</radius><length>0.30</length></cylinder></geometry>
        </collision>
      </link>
    </model>

    <!-- Block #1 -->
    <model name="block_1">
      <static>true</static>
      <pose>-2.00 14.00 0.10 0 0 0.5236</pose>  <!-- ~30° -->
      <link name="body">
        <visual name="v">
          <geometry><box><size>0.80 0.20 0.20</size></box></geometry>
          <material><ambient>1 0 0 1</ambient><diffuse>1 0 0 1</diffuse></material>
        </visual>
        <collision name="c">
          <geometry><box><size>0.80 0.20 0.20</size></box></geometry>
        </collision>
      </link>
    </model>

    <!-- Cone #2 -->
    <model name="cone_2">
      <static>true</static>
      <pose>8.60 9.80 0.15 0 0 0</pose>
      <link name="body">
        <visual name="v">
          <geometry><cylinder><radius>0.12</radius><length>0.30</length></cylinder></geometry>
          <material><ambient>1.0 0.4 0.0 1</ambient><diffuse>1.0 0.4 0.0 1</diffuse></material>
        </visual>
        <collision name="c">
          <geometry><cylinder><radius>0.12</radius><length>0.30</length></cylinder></geometry>
        </collision>
      </link>
    </model>

    <!-- Block #2 -->
    <model name="block_2">
      <static>true</static>
      <pose>-6.70 5.90 0.10 0 0 0.2618</pose>  <!-- ~15° -->
      <link name="body">
        <visual name="v">
          <geometry><box><size>0.60 0.25 0.20</size></box></geometry>
          <material><ambient>0.9 0.2 0.2 1</ambient><diffuse>0.9 0.2 0.2 1</diffuse></material>
        </visual>
        <collision name="c">
          <geometry><box><size>0.60 0.25 0.20</size></box></geometry>
        </collision>
      </link>
    </model>

    <!-- Vật lý -->
    <physics name="default_physics" type="ode">
      <max_step_size>0.001</max_step_size>
      <real_time_update_rate>1000</real_time_update_rate>
      <real_time_factor>1.0</real_time_factor>
    </physics>

  </world>
</sdf>
